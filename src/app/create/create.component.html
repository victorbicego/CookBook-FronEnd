<div class="form-container">
  <mat-card class="create-form">
    <div>
      <p>
        Enter the new recipe information.
      </p>
    </div>

    <form [formGroup]="recipeCreateFormGroup" class="my-form">

      <mat-form-field class="name" appearance="fill">
        <mat-label>Recipe's name</mat-label>
        <input type="text" matInput placeholder="Ex. Pizza" formControlName="name">
      </mat-form-field>

      <mat-form-field class="author" appearance="fill">
        <mat-label>Recipe's author</mat-label>
        <input type="text" matInput placeholder="Ex. Toni Stark" formControlName="author">
      </mat-form-field>

      <div formArrayName="ingredients">
        <div *ngFor="let _ of ingredients.controls; index as i">
          <form [formGroupName]="i">
            <mat-form-field class="unity" appearance="fill">
              <mat-label>Unity</mat-label>
              <mat-select formControlName="unity">
                <mat-option *ngFor="let option of unities" [value]="option">{{option}}</mat-option>
              </mat-select>
            </mat-form-field>

            <mat-form-field class="quantity" appearance="fill">
              <mat-label>Quantity</mat-label>
              <input type="number" matInput placeholder="Ex. 200" formControlName="quantity">
            </mat-form-field>

            <mat-form-field class="ingredientName" appearance="fill">
              <mat-label>Name</mat-label>
              <input matInput placeholder="Ex. Cheese" formControlName="ingredientName">
            </mat-form-field>
          </form>
          <button (click)="removeIngredient(i)" [disabled]="ingredients.length==1">Remove choice</button>
        </div>
      </div>
      <button (click)="addIngredient()" [disabled]="!ingredients.valid">Add another ingredient</button>


      <mat-form-field class="example-full-width" appearance="fill">
        <mat-label>Recipe's instructions</mat-label>
        <textarea type="text" matInput placeholder="Ex. First cut the tomatoes..."
                  formControlName="instructions"></textarea>
      </mat-form-field>

      <mat-form-field class="example-full-width" appearance="fill">
        <mat-label>Difficulty</mat-label>
        <mat-select formControlName="difficulty">
          <mat-option *ngFor="let difficulty of difficulties" [value]="difficulty">{{difficulty}}</mat-option>
        </mat-select>
      </mat-form-field>

      <mat-form-field class="example-full-width" appearance="fill">
        <mat-label>Category</mat-label>
        <mat-select formControlName="category">
          <mat-option *ngFor="let category of categories" [value]="category">{{category}}</mat-option>
        </mat-select>
      </mat-form-field>

      <mat-form-field class="example-full-width" appearance="fill">
        <mat-label>Cuisine</mat-label>
        <mat-select formControlName="cuisine">

          <mat-optgroup *ngFor="let cuisine of cuisines" [label]="cuisine.continent">
            <mat-option *ngFor="let country of cuisine.countries" [value]="country">
              {{country}}
            </mat-option>
          </mat-optgroup>
          <mat-option value="Other">Other
          </mat-option>

        </mat-select>
      </mat-form-field>

      <mat-form-field class="example-full-width" appearance="fill">
        <mat-label>Recipe's preparation time (minutes)</mat-label>
        <input type="number" matInput placeholder="Ex. 120" formControlName="preparationTime">
      </mat-form-field>

      <mat-form-field class="example-full-width" appearance="fill">
        <mat-label>Recipe's portions</mat-label>
        <input type="number" matInput placeholder="Ex. 2" formControlName="portion">
      </mat-form-field>

      <mat-form-field class="example-chip-list" appearance="fill">
        <mat-label>Hashtags</mat-label>

        <mat-chip-list aria-label="Hashtags" multiple formControlName="hashtags">

          <mat-chip
            *ngFor="let hashtag of hashtags"
            [value]="hashtag"
            (click)="chip.selected ? chip.deselect() : chip.selectViaInteraction()"
            #chip="matChip">
            #{{hashtag}}
          </mat-chip>

        </mat-chip-list>


      </mat-form-field>

      <button mat-button (click)="popupConfirmation()" [disabled]="!recipeCreateFormGroup.valid">Save</button>
    </form>

  </mat-card>

  <div *ngIf="showConfirm">
    <p>Are you sure?</p>
    <button mat-button type="submit" (click)="confirmInput()">Yes</button>
    <button mat-button (click)="denyInput()">No</button>
  </div>
</div>
